# PHP面试-其他

1.中间件

2.微服务


3.如何查看PHP cup占用

	ps aux|grep -c php

	当PHP服务器cpu使用过高时，查看nginx日志，分析出请求时间长的请求


4.如何查看端口开放情况

	1.查看某一个端口：lsof -i:80

	2.netstat -atu
	
	3.只看TCP端口:netstat -ntpl

	4.只看UDP端口:netstat -nupl

	5.防火墙查看所有开放的端口：firewall-cmd --list-ports
	
	6.防火墙查看特定端口：firewall-cmd --query-port=8080/tcp


# 削峰

基于“请求数要尽量少”的设计原则，削峰本质上就是延缓更多用户请求的发出，减少和过滤一些无效请求。
消息队列缓冲瞬时流量，同步操作转换为异步间接推送，中间通过队列在一端承接瞬时流量洪峰，另一端平滑推送消息出去。

削峰的三种处理方式：

通过队列缓冲请求，控制请求发出；
通过答题延长请求发出时间，请求发出后，承接（服务端、缓存、数据库）请求时进行控制，最后再对不符合条件的请求进行过滤；
对请求进行分层过滤；

适用场景


| 场景 | 作用 |
| --- | --- |
| 队列缓冲 |  
更通用，适用于内部上下游系统之间调用请求不平缓的场景，由于内部系统的服务质量不允许随意丢弃请求，所以使用消息队列能起到很好的削峰和缓冲作用。

 |  |
| 答题 | 秒杀或营销活动，在请求发起端控制请求速度，越到后面无效请求越多，所以配合后面介绍分层拦截方式，可进一步减少无效请求对系统资源对占用。 

 |  |
| 分层过滤 | 非常适合交易性的写请求，比如减库存、拼车场景，因为库存和座位是不断变化的，读的时候不需要非常准确，可以先放一些请求过去，然后真正减少时一定要做到强一致性，这样即过滤一些请求又解决了强一致性读的瓶颈。 
 |  |




| 场景 | 作用 |
| --- | --- | 
| 队列缓冲 |  |  
| 答题|  | 
| 分层过滤 |  | 

